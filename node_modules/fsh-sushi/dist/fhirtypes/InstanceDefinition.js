"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cloneDeep = require("lodash/cloneDeep");
const common_1 = require("./common");
const utils_1 = require("../utils");
/**
 * A class representing a FHIR Instance.
 *
 * The defined properties on InstanceDefinition are relatively simple due to the fact that each FHIR resource will
 * be setting different properties based on their own definitions.
 */
class InstanceDefinition {
    constructor() {
        this._instanceMeta = {};
    }
    /**
     * Get the file name for serializing to disk.
     * @returns {string} the filename
     */
    getFileName() {
        var _a;
        return `${this.resourceType}-${(_a = this.id) !== null && _a !== void 0 ? _a : this._instanceMeta.name}.json`;
    }
    toJSON() {
        const clone = cloneDeep(this);
        delete clone._instanceMeta; // Only needed for lookup and IG config - not a FHIR property
        return clone;
    }
    static fromJSON(json) {
        const instanceDefinition = new InstanceDefinition();
        Object.keys(json).forEach(key => {
            instanceDefinition[key] = json[key];
        });
        // Default the meta name to the id
        if (json.id != null) {
            instanceDefinition._instanceMeta.name = json.id;
        }
        return instanceDefinition;
    }
}
exports.InstanceDefinition = InstanceDefinition;
utils_1.applyMixins(InstanceDefinition, [common_1.HasId]);
//# sourceMappingURL=InstanceDefinition.js.map